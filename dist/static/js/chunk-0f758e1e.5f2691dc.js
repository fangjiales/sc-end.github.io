(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f758e1e"],{b2db:function(e,t,s){},c9fa:function(e,t,s){"use strict";s("b2db")},e382:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-container"},[s("div",{staticClass:"user-search user-item"},[s("el-input",{staticClass:"user-keyword-input",attrs:{placeholder:"请输入关键字查询",maxlength:200,size:"small",clearable:!0,"prefix-icon":"el-icon-search"},on:{clear:e.getUserInfo},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),s("el-button",{staticClass:"query-key-btn",attrs:{type:"primary",size:"small"},on:{click:e.queryHandle}},[e._v("查询")]),s("el-button",{staticClass:"reset-key-btn",attrs:{type:"warning",size:"small"},on:{click:e.resetHandle}},[e._v("重置")])],1),s("div",{staticClass:"user-operator user-item"},[s("el-button",{attrs:{type:"success",size:"small"},on:{click:e.addUser}},[e._v("新增")]),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.batchDelete}},[e._v("批量删除")])],1),s("div",{staticClass:"user-list user-item"},[s("el-table",{staticClass:"user-table",staticStyle:{width:"100%"},attrs:{data:e.userInfo.records},on:{select:e.tableSelectHandle,"select-all":e.tableAllSelectHandle}},[s("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),s("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),s("el-table-column",{attrs:{prop:"username",label:"用户名",width:"100",align:"center","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-image",{staticClass:"user-avatar",attrs:{fit:"fill",src:t.row.avatar,"preview-src-list":e.avatarList}})]}}])}),s("el-table-column",{attrs:{prop:"sex",label:"性别",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.sex?"女":"男"))])]}}])}),s("el-table-column",{attrs:{prop:"status",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{value:!!t.row.status},on:{change:function(s){return e.updateStatus(t.row)}}})]}}])}),s("el-table-column",{attrs:{prop:"phone",label:"电话",width:"120",align:"center","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"120",align:"center","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"introduction",label:"描述",align:"center","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"120",align:"center","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{width:"200",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return e.editUser(t.row)}}},[e._v("编辑")]),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return e.removeUser(t.row)}}},[e._v("删除")])]}}])})],1),s("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.userInfo.total},on:{"size-change":e.sizeChangeHandle,"current-change":e.pageChangeHandle,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1),s("div",{staticClass:"dialogs"},[s("el-dialog",{attrs:{title:e.editUserDialogTitle,visible:e.showEditUserDialog,width:"40%","before-close":e.editUserDialogCloseHandle},on:{"update:visible":function(t){e.showEditUserDialog=t}}},[s("el-form",{ref:"userForm",attrs:{model:e.user,rules:e.userRules,size:"small","label-width":"80px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入您的用户名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),s("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://127.0.0.1:9966/file/upload",headers:{token:e.token},"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.user.avatar?s("img",{staticClass:"avatar",attrs:{src:e.user.avatar}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),s("el-form-item",{attrs:{label:"性别",prop:"sex"}},[s("el-select",{attrs:{placeholder:"请选择您的性别"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[s("el-option",{attrs:{label:"男",value:0}}),s("el-option",{attrs:{label:"女",value:1}})],1)],1),s("el-form-item",{attrs:{label:"状态",prop:"status"}},[s("el-switch",{attrs:{value:!!e.user.status},on:{change:function(t){return e.triggerStatus(e.user.status)}}})],1),s("el-form-item",{attrs:{label:"电话",prop:"phone"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入您的电话"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入您的邮箱"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),s("el-form-item",{attrs:{label:"描述",prop:"introduction"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入您的描述"},model:{value:e.user.introduction,callback:function(t){e.$set(e.user,"introduction",t)},expression:"user.introduction"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.editUserDialogCloseHandle}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.confirmSubmit}},[e._v("确认")])],1)],1)],1)])},r=[],i=s("5530"),n=(s("caad"),s("d81d"),s("2532"),s("5c96")),l=s("2f62"),o=(s("ac1f"),s("00b4"),{usernameValid:function(e,t,s){(t.length<3||t.length>10)&&s(new Error("用户名必须3~9位")),s()},passwordValid:function(e,t,s){(t.length<3||t.length>10)&&s(new Error("密码必须3~9位")),s()},phoneValid:function(e,t,s){/^1[3456789]\d{9}$/.test(t)||s(new Error("电话格式错误")),s()},emailValid:function(e,t,s){/^\w+@\w+\.\w+$/.test(t)||s(new Error("邮箱格式错误")),s()}}),c={username:[{trigger:"blur",validator:o.usernameValid}],password:[{trigger:"blur",validator:o.passwordValid}],phone:[{trigger:"blur",validator:o.phoneValid}],email:[{trigger:"blur",validator:o.emailValid}],introduction:[{required:!0,trigger:"blur",message:"描述不能为空"}]},u=function(){return{id:"",username:"",avatar:void 0,sex:0,status:1,phone:"",email:"",introduction:""}},d={name:"User",data:function(){return{keyword:"",page:1,size:10,showEditUserDialog:!1,editUserDialogTitle:"",user:u(),userRules:c,selectList:[]}},methods:{getUserInfo:function(){this.$store.dispatch("admin/getUserInfo",{page:this.page,size:this.size,keyword:this.keyword}).then((function(e){console.log(e),Object(n["Message"])({type:"success",message:"retrieve user list success",duration:1e3})})).catch((function(e){Object(n["Message"])({type:"error",message:e.message||"获取用户信息失败",duration:1e3})}))},saveOrUpdateUser:function(e){var t=this;e.id?this.$store.dispatch("admin/updateUser",e).then((function(e){Object(n["Message"])({type:"success",message:"修改用户信息成功",duration:1e3}),t.getUserInfo()})).catch((function(e){Object(n["Message"])({type:"error",message:"修改用户信息失败",duration:1e3})})):(e.password="123456",this.$store.dispatch("admin/saveUser",e).then((function(e){Object(n["Message"])({type:"success",message:"添加用户成功",duration:1e3}),t.getUserInfo()})).catch((function(e){Object(n["Message"])({type:"error",message:"添加用户失败",duration:1e3})}))),this.showEditUserDialog=!1,this.user=u()},confirmSubmit:function(){var e=this;this.$refs.userForm.validate((function(t){t?e.saveOrUpdateUser(e.user):Object(n["Message"])({type:"error",message:"数据格式不匹配",duration:1e3})}))},batchDelete:function(){var e=this;this.selectList.length<1?Object(n["Message"])({type:"error",message:"请先选择要删除的用户",duration:1e3}):this.$confirm("您确认要删除吗?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(t){e.$store.dispatch("admin/batchDelete",e.selectList).then((function(t){e.page=1,Object(n["Message"])({type:"success",message:"删除成功",duration:1e3}),e.getUserInfo()})).catch((function(e){Object(n["Message"])({type:"error",message:"删除失败",duration:1e3})}))})).catch((function(e){console.log(e)}))},addUser:function(){this.editUserDialogTitle="添加用户",this.showEditUserDialog=!0},editUser:function(e){var t=this;this.$store.dispatch("admin/getById",e.id).then((function(e){t.user=e.data,t.editUserDialogTitle="修改用户",t.showEditUserDialog=!0})).catch((function(e){Object(n["Message"])({type:"error",message:e.message,duration:1e3})}))},removeUser:function(e){this.selectList=[e.id],this.batchDelete()},updateStatus:function(e){this.$store.dispatch("admin/updateUser",e).then((function(t){e.status=1-e.status,Object(n["Message"])({type:"success",message:"修改用户状态成功",duration:1e3})})).catch((function(e){Object(n["Message"])({type:"error",message:"修改用户状态失败",duration:1e3})}))},queryHandle:function(){this.getUserInfo()},resetHandle:function(){this.keyword="",this.getUserInfo()},sizeChangeHandle:function(e){this.size=e,this.getUserInfo()},pageChangeHandle:function(e){this.page=e,this.getUserInfo()},editUserDialogCloseHandle:function(){this.user=u(),this.editUserDialogTitle="",this.showEditUserDialog=!1},handleAvatarSuccess:function(e,t){this.user.avatar=e.data},beforeAvatarUpload:function(e){var t=e.type;return t.includes("image")},triggerStatus:function(e){this.user.status=1-e},tableSelectHandle:function(e){this.selectList=e.map((function(e){return e.id}))},tableAllSelectHandle:function(e){this.selectList=e.map((function(e){return e.id}))}},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(l["c"])("admin",["userInfo"])),Object(l["b"])(["token"])),{},{avatarList:function(){return this.userInfo.records.map((function(e){return e.avatar}))}}),mounted:function(){this.getUserInfo()}},p=d,h=(s("c9fa"),s("2877")),f=Object(h["a"])(p,a,r,!1,null,"250c2788",null);t["default"]=f.exports}}]);